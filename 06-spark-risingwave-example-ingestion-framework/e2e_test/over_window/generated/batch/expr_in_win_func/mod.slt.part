# This file is generated by `gen.py`. Do not edit it manually!

# Test expressions as window function args/PARTITION BY/ORDER BY.

statement ok
create table t (
      id int
    , p1 int
    , p2 int
    , time int
    , v1 int
    , v2 int
);

statement ok
create view v as
select
    *
    , t.v2 as out1
    , 0 as out2
    , first_value(v1) over (partition by p1, p2 order by time, id rows 3 preceding) as out3
    , lag(v1 + 2, 0 + 1) over (partition by p1 - 1 order by id) as out4
    , min(v1 * 2) over (partition by p1, p2 order by time + 1, id rows between current row and unbounded following) as out5
from t;

statement ok
insert into t values
  (100001, 100, 200, 1, 701, 805)
, (100002, 100, 200, 2, 700, 806)
, (100003, 100, 208, 2, 723, 807)
, (100004, 103, 200, 2, 702, 808);

statement ok
insert into t values
  (100005, 100, 200, 3, 717, 810)
, (100006, 105, 204, 5, 703, 828);

statement ok
update t set v1 = 799 where id = 100002; -- value change

statement ok
update t set p2 = 200 where id = 100003; -- partition change

statement ok
update t set "time" = 1 where id = 100005; -- order change

query iiiiiiiiii
select * from v order by id;
----
100001 100 200 1 701 805 805 0 701 NULL 1402
100002 100 200 2 799 806 806 0 701 703 1446
100003 100 200 2 723 807 807 0 701 801 1446
100004 103 200 2 702 808 808 0 702 NULL 1404
100005 100 200 1 717 810 810 0 701 725 1434
100006 105 204 5 703 828 828 0 703 NULL 1406

statement ok
delete from t where time = 2;

query iiiiiiiiii
select * from v order by id;
----
100001 100 200 1 701 805 805 0 701 NULL 1402
100005 100 200 1 717 810 810 0 701 703 1434
100006 105 204 5 703 828 828 0 703 NULL 1406

statement ok
drop view v;

statement ok
drop table t;
